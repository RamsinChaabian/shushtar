async function fetchLanguageData(e){return(await fetch(`languages/${e}.json`)).json()}function setLanguagePreference(e){localStorage.setItem("language",e),location.reload()}function updateContent(e){document.querySelectorAll("[data-i18n]").forEach(t=>{const n=t.getAttribute("data-i18n");t.textContent=e[n]})}async function changeLanguage(e){await setLanguagePreference(e),updateContent(await fetchLanguageData(e)),toggleArabicStylesheet(e)}function toggleArabicStylesheet(e){const t=document.querySelector("head"),n=document.querySelector("#styles-link");if(n)t.removeChild(n);else if("ar"===e){const e=document.createElement("link");e.id="styles-link",e.rel="stylesheet",e.href="./assets/css/style-ar.css",t.appendChild(e),document.querySelectorAll("img.rounded-end-4").forEach(function(e){e.classList.remove("rounded-end-4")})}}async function getWeatherForecast(){try{const e=await fetch("https://api.openweathermap.org/data/2.5/forecast?q=shushtar,ir&APPID=029a87c28964f9d5c30f9840196cd747");if(!e.ok)throw new Error("Network response was not ok.");const t=(await e.json()).list,n=document.querySelector(".modal-body");let a='\n        <div class="table-responsive">\n        <table class="table table-striped text-center table-success" style="font-size: smaller;max-height: 200px;overflow: auto;display:inline-block;">\n            <thead>\n                <tr>\n                    <th data-i18n="date"></th>\n                    <th data-i18n="temperature"></th>\n                    <th data-i18n="status"></th>\n                    <th data-i18n="feels_like"></th>\n                </tr>\n            </thead>\n            <tbody>\n    ';t.forEach(e=>{let t=e.dt_txt;const n=getComputedStyle(document.body).direction,[o,r]=t.split(" "),[s,l,i]=o.split("-"),[c,d,u]=r.split(":");let m="";if("ltr"===n){t=new Date(s,l-1,i,c,d,u),t=new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"short"}).format(t),m="text-start"}else if("rtl"===n){t=new Date(s,l-1,i,c,d,u),t=new Intl.DateTimeFormat("ar-SA",{dateStyle:"full",timeStyle:"short"}).format(t),m="text-end"}const h=e.main.temp,p=Math.round(h-273.15),f=e.main.feels_like-273.15,y=e.weather[0].icon;a+=`\n                <tr>\n                    <td class="${m}">${t}</td>\n                    <td dir="ltr"><span class="fw-bold">${p.toFixed(0)}</span><span class="fw-bold">&#8451;</span></td>\n                    <td><img loading="lazy" style="width: 100%;object-fit: none;" height="75" width="75" src="https://openweathermap.org/img/wn/${y}@2x.png" alt="Weather Icon"></td>\n                    <td dir="ltr"><span class="fw-bold">${f.toFixed(0)}</span><span class="fw-bold">&#8451;</span></td>\n                </tr>\n            `}),a+="\n                </tbody>\n            </table>\n            </div>",n.innerHTML=a;const o=localStorage.getItem("language")||"en";updateContent(await fetchLanguageData(o))}catch(e){console.error("There was a problem with the fetch operation:",e.message)}}window.addEventListener("DOMContentLoaded",async()=>{const e=localStorage.getItem("language")||"en";if(updateContent(await fetchLanguageData(e)),toggleArabicStylesheet(e),"ar"===document.documentElement.lang){const e=document.querySelector("head");if(!document.querySelector("#styles-link")){const t=document.createElement("link");t.id="styles-link",t.rel="stylesheet",t.href="./assets/css/style-ar.css",e.appendChild(t),document.querySelectorAll("img.rounded-end-4").forEach(e=>{e.classList.remove("rounded-end-4")})}}}),document.addEventListener("DOMContentLoaded",async function(){try{const e=await fetch("https://api.openweathermap.org/data/2.5/weather?q=shushtar,ir&APPID=029a87c28964f9d5c30f9840196cd747");if(!e.ok)throw new Error("Network response was not ok.");const t=await e.json(),n=t.main.temp,a=Math.round(n-273.15),o=t.main.feels_like-273.15,r=t.main.pressure,s=t.main.humidity,l=t.wind.speed,i=t.weather[0].icon,c="<span>"+a.toFixed(0)+"</span>",d="<span>"+o.toFixed(0)+"</span>",u="<span>"+r+"</span>",m="<span>"+s+"</span>",h="<span>"+l.toFixed(1)+"</span>";document.querySelector(".temperature").innerHTML=c,document.querySelector(".feels-like").innerHTML=d,document.querySelector(".pressure").innerHTML=u,document.querySelector(".humidity").innerHTML=m,document.querySelector(".wind-speed").innerHTML=h;const p=getComputedStyle(document.body).direction;document.querySelector(".temperature").classList.add(p),document.querySelector(".feels-like").classList.add(p),document.querySelector(".pressure").classList.add(p),document.querySelector(".humidity").classList.add(p),document.querySelector(".wind-speed").classList.add(p),document.querySelector(".weathericon").innerHTML='<img height="75" width="75" src="https://openweathermap.org/img/wn/'+i+'@2x.png" alt="Weather Icon">'}catch(e){console.error("There was a problem with the fetch operation:",e.message)}});var popupElement=document.getElementById("weatherPopup");async function fetchTehranTime(){try{const e=await fetch("https://worldtimeapi.org/api/timezone/Asia/Tehran");if(!e.ok)throw new Error("Network response was not ok.");const t=await e.json(),n=document.getElementById("tehrantime"),a=new Date(t.datetime),o=getComputedStyle(document.body).direction;if("ltr"===o){const e=new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"full"});n.textContent=e.format(a)}else if("rtl"===o){const e=new Intl.DateTimeFormat("ar-SA",{dateStyle:"full",timeStyle:"full"});n.textContent=e.format(a)}}catch(e){console.error("Error:",e.message)}}popupElement&&popupElement.addEventListener("show.bs.modal",getWeatherForecast),window.onload=function(){const e=document.getElementById("weatherNews");e.addEventListener("mouseenter",function(){this.style.animationPlayState="paused"}),e.addEventListener("mouseleave",function(){this.style.animationPlayState="running"})},fetchTehranTime(),setInterval(fetchTehranTime,1e3);